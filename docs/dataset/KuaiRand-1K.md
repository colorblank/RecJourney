# KuaiRand-1K 数据集特征文档

本文档列出了 KuaiRand-1K 数据集中的主要特征及其分类。这些特征用于推荐系统的数据预处理和模型训练。

## 数据集概述与特征详情

本文档详细列出了 KuaiRand-1K 数据集中的主要特征及其分类，并提供了数据路径、统计信息和示例值的获取方式。这些特征是推荐系统数据预处理和模型训练的基础。

### 1. 数据路径

KuaiRand-1K 数据集文件位于项目根目录下的 `KuaiRand-1K/data/` 目录。该目录包含以下核心 CSV 文件：

*   `log_standard_4_08_to_4_21_1k.csv`：标准曝光日志数据（2022年4月8日至4月21日）
*   `log_standard_4_22_to_5_08_1k.csv`：标准曝光日志数据（2022年4月22日至5月8日）
*   `log_random_4_22_to_5_08_1k.csv`：随机曝光日志数据（2022年4月22日至5月8日）
*   `user_features_1k.csv`：用户静态特征数据
*   `video_features_basic_1k.csv`：视频基础特征数据
*   `video_features_statistic_1k.csv`：视频统计特征数据

在数据预处理阶段，这些文件会被加载并合并为一个完整的 DataFrame。

### 2. 数据列与含义

数据集中的特征根据其数据类型和用途进行分类：

#### 2.1. 数值特征 (Numerical Features)

**说明**：这些特征的值是连续的数值，通常反映数量、时长或计数。在模型训练前，它们可能需要进行归一化（如 Min-Max 归一化）或分桶处理，以适应模型的输入要求。

*   `play_time_ms`: 播放时长（毫秒）
*   `duration_ms`: 视频总时长（毫秒）
*   `profile_stay_time`: 个人主页停留时间
*   `comment_stay_time`: 评论区停留时间
*   `follow_user_num`: 用户关注数
*   `fans_user_num`: 用户粉丝数
*   `friend_user_num`: 用户好友数
*   `register_days`: 用户注册天数
*   `video_duration`: 视频时长
*   `show_cnt`: 视频展示次数
*   `play_cnt`: 视频播放次数
*   `play_duration`: 视频播放总时长
*   `like_cnt`: 视频点赞次数
*   `comment_cnt`: 视频评论次数
*   `share_cnt`: 视频分享次数
*   `download_cnt`: 视频下载次数
*   `collect_cnt`: 视频收藏次数

#### 2.2. 类别特征 (Categorical Features)

**说明**：这些特征的值是离散的，表示不同的类别或分组。它们通常用于对实体进行分类。在预处理时，可能需要进行独热编码 (One-Hot Encoding) 或标签编码 (Label Encoding) 转换为数值形式。

*   `user_active_degree`: 用户活跃度
*   `follow_user_num_range`: 用户关注数范围
*   `fans_user_num_range`: 用户粉丝数范围
*   `friend_user_num_range`: 用户好友数范围
*   `register_days_range`: 用户注册天数范围
*   `video_type`: 视频类型
*   `upload_type`: 上传类型
*   `music_type`: 音乐类型

#### 2.3. 多值特征 (Multivalued Features)

**说明**：单个条目可能包含多个值，例如一个视频可以有多个标签。这类特征通常需要特殊处理，如多热编码 (Multi-Hot Encoding) 或嵌入层处理。

*   `tag`: 视频标签（通常是逗号分隔的ID列表）

#### 2.4. 布尔特征 (Boolean Features)

**说明**：这些特征的值通常为布尔类型（真/假），表示某种状态或属性是否存在。在处理时，它们通常被转换为 0/1 的整数形式。

*   `is_lowactive_period`: 是否处于低活跃期
*   `is_live_streamer`: 是否是直播主播
*   `is_video_author`: 是否是视频作者
*   `is_click`: 是否点击（标签）
*   `is_like`: 是否点赞（标签）
*   `is_follow`: 是否关注（标签）
*   `is_comment`: 是否评论（标签）
*   `is_forward`: 是否转发（标签）
*   `is_hate`: 是否不喜欢（标签）
*   `long_view`: 是否长时观看
*   `is_profile_enter`: 是否进入个人主页
*   `is_rand`: 是否随机曝光

#### 2.5. ID 特征 (ID Features)

**说明**：这些特征用于唯一标识数据集中的用户或物品。它们通常作为嵌入层的输入，用于学习用户和物品的表示。

*   `user_id`: 用户ID
*   `video_id`: 视频ID

#### 2.6. 标签特征 (Label Features)

**说明**：这些特征是模型预测的目标变量，通常用于监督学习任务。

*   `is_click`: 是否点击（主要预测目标）

#### 2.7. 时间特征 (Time Features)

**说明**：这些特征与事件发生的时间相关。在预处理中，可以从中提取出时间戳、日期、小时、星期几等信息，作为新的特征。

*   `time_ms`: 事件发生时间（毫秒）

### 3. 统计信息

数据集的统计信息对于理解数据分布、识别异常值和指导特征工程至关重要。`preprocess/kuairand_preprocess.py` 脚本在预处理过程中会动态计算并提供以下类型的统计信息：

*   **数值特征**: 计算每个数值特征的百分位数（分位数），例如 25%、50%（中位数）、75% 等，以揭示数据的集中趋势和离散程度。以下是数值特征的完整百分位数列表（已四舍五入到小数点后两位）：

    *   `play_time_ms`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 1800000.0, 1800000.0, 1800000.0, 1800000.0, 1800000.0]
    *   `duration_ms`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 50000.0, 50000.0, 50000.0, 50000.0, 50000.0]
    *   `profile_stay_time`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 1800000.0, 1800000.0, 1800000.0, 1800000.0, 1800000.0]
    *   `comment_stay_time`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 1800000.0, 1800000.0, 1800000.0, 1800000.0, 1800000.0]
    *   `follow_user_num`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 500.0, 500.0, 500.0, 500.0, 500.0]
    *   `fans_user_num`: [0.0, 0.0, 0.0, 1.0, 1.0, ..., 100000.0, 100000.0, 100000.0, 100000.0, 100000.0]
    *   `friend_user_num`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 250.0, 250.0, 250.0, 250.0, 250.0]
    *   `register_days`: [47.0, 80.0, 108.0, 175.0, 191.0, ..., 730.0, 730.0, 730.0, 730.0, 730.0]
    *   `video_duration`: [5560.0, 6033.0, 6333.0, 6666.0, 6958.0, ..., 50000.0, 50000.0, 50000.0, 50000.0, 50000.0]
    *   `show_cnt`: [31.37, 62.76, 101.28, 146.95, 199.70, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `play_cnt`: [10.27, 20.59, 33.95, 51.61, 73.54, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `play_duration`: [87118.89, 182049.00, 316997.30, 508891.56, 757217.11, ..., 1800000.0, 1800000.0, 1800000.0, 1800000.0, 1800000.0]
    *   `like_cnt`: [0.34, 0.64, 0.94, 1.26, 1.60, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `comment_cnt`: [0.0, 0.03, 0.05, 0.08, 0.11, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `share_cnt`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `download_cnt`: [0.0, 0.0, 0.0, 0.0, 0.0, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]
    *   `collect_cnt`: [0.0, 0.0, 0.03, 0.06, 0.09, ..., 1000000.0, 1000000.0, 1000000.0, 1000000.0, 1000000.0]

*   **类别特征**: 统计每个类别特征的唯一值及其对应的出现次数，以了解各类别在数据集中的分布情况。以下是类别特征的唯一值数量示例：
    *   `user_active_degree`: {'full_active': 8973268, 'high_active': 1882303, 'middle_active': 574282, '2_14_day_new': 227151, 'low_active': 81794, '30day_retention': 12565, 'single_low_active': 4710}
    *   `follow_user_num_range`: {'500+': 2453297, '(10,50]': 2035392, '(250,500]': 1908408, '(50,100]': 1836668, '(150,250]': 1625670, '(100,150]': 1163343, '(0,10]': 681811, '0': 51484}
    *   `fans_user_num_range`: {'[10,100)': 4377919, '[100,1k)': 4190779, '[1,10)': 2066679, '[1k,5k)': 554048, '0': 371228, '[1w,10w)': 103215, '[5k,1w)': 84893, '[10w,100w)': 7312}
    *   `friend_user_num_range`: {'[5,30)': 3304374, '[1,5)': 2077270, '[30,60)': 1490315, '[60,120)': 1406883, '[120,250)': 1303899, '250+': 1092646, '0': 1080686}
    *   `register_days_range`: {'730+': 9195343, '366-730': 1343404, '181-365': 726171, '91-180': 229797, '31-60': 108593, '61-90': 81164, '15-30': 71601}
    *   `video_type`: {'NORMAL': 11696236, 'AD': 58762, 'UNKNOWN': 1075}
    *   `upload_type`: {'LongImport': 3318501, 'ShortImport': 2689634, 'Kmovie': 1924703, 'Web': 1823751, 'LongPicture': 550498, 'LongCamera': 435935, 'ShortCamera': 406448, 'PictureCopy': 172962, 'PictureSet': 161862, 'UNKNOWN': 74512, 'ShareFromOtherApp': 52128, 'FollowShoot': 33649, 'PhotoCopy': 31266, 'AiCutVideo': 19314, 'SameFrame': 18007, 'Recreation': 17807, 'FlashPhoto': 10921, 'OriginPicture': 6501, 'LocalIntelligenceAlbum': 2587, 'LipsSync': 2383, 'LiveClip': 1447, 'Karaoke': 389, 'Status': 278, 'StoryMoodTemplate': 274, 'LocalCollection': 240, 'ALBUM2021': 25, 'Solitaire': 24, 'ShortOriginImport': 14, 'Copy': 6, 'CommonAvatar': 4, 'ResidentChange': 2, 'ShootRecognition': 1}

**如何获取完整的统计信息和示例数据：**

完整的统计值和示例数据行需要通过运行预处理脚本来动态生成。请执行以下命令：

```bash
uv run python preprocess/kuairand_preprocess.py
```

运行后，脚本的输出中将包含详细的数值特征分位数、类别特征的唯一值数量以及预处理后的数据的前几行示例。
